(function($){$.fn.visible=function(partial,hidden){var $t=$(this).eq(0),t=$t.get(0),$w=$(window),viewTop=$w.scrollTop(),viewBottom=viewTop+$w.height(),_top=$t.offset().top,_bottom=_top+$t.height(),compareTop=_top,compareBottom=_bottom,clientSize=true;return!!clientSize&&(compareBottom<=viewBottom&&compareTop>=viewTop)};var table,searchFilter,elementsTemplate,allData;$.fn.commandPalette=function(methodOrOptions){var filteredData,onItemSelected,onFilter;var methods={init:function(options){elementsTemplate=options.elementsTemplate;onItemSelected=options.onItemSelected;onFilter=options.onFilter;allData=filteredData=options.items||[];if(elementsTemplate){var compiledTemplate=tmpl(elementsTemplate);compileTemplateFunction=function(item){item.tmpl='<div id="item-'+item.index+'">'+compiledTemplate(item)+"</div>"}}else{compileTemplateFunction=function(item){item.tmpl='<div id="item-'+item.index+'">$$string$$</div>'}}for(var i=0,li=allData.length;i<li;i++){allData[i].index=i;compileTemplateFunction(allData[i])}this.append('<input type="text" class="searchFilter" placeholder="Search ..."><div class="results"></div>');table=this.find(".results");searchFilter=this.find(".searchFilter").focus();updateTableDOM();document.onclick=function(event){if(event.toElement.id.substring(0,5)==="item-"){var selectedIndex=parseInt(event.toElement.id.substring(5),10);onItemSelected(allData[selectedIndex])}};searchFilter.keydown(function(event){var keyCode=event.keyCode;if(keyCode=="38"){var selected=table.find(".selected");var prev=selected.prev();if(prev.length){prev.addClass("selected");selected.removeClass("selected");if(!prev.prev().visible()){prev.get(0).scrollIntoView()}}}else if(keyCode=="40"){var selected=table.find(".selected");var next=selected.next();if(next.length){next.addClass("selected");selected.removeClass("selected");if(!next.visible()){next.get(0).scrollIntoView(false)}}}else if(keyCode=="13"){var selectedIndex=parseInt(table.find(".selected")[0].id.substring(5),10);onItemSelected(allData[selectedIndex])}else{fuzzySearch()}})},update:function(items){allData=filteredData=items||[];if(elementsTemplate){var compiledTemplate=tmpl(elementsTemplate);compileTemplateFunction=function(item){item.tmpl='<div id="item-'+item.index+'">'+compiledTemplate(item)+"</div>"}}else{compileTemplateFunction=function(item){item.tmpl='<div id="item-'+item.index+'">$$string$$</div>'}}for(var i=0,li=allData.length;i<li;i++){allData[i].index=i;compileTemplateFunction(allData[i])}updateTableDOM()}};if(methods[methodOrOptions]){return methods[methodOrOptions].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof methodOrOptions==="object"||!methodOrOptions){return methods.init.apply(this,arguments)}else{$.error("Method "+methodOrOptions+" does not exist on jQuery.commandPalette")}function createResultElement(item){var tmpl=item.tmpl||item.original.tmpl;return $(tmpl.replace("$$string$$",item.string))}function updateTableDOM(){table.empty();var fragment=document.createDocumentFragment();if(filteredData.length){var el=createResultElement(filteredData[0]).addClass("selected");fragment.appendChild(el.get(0));for(var i=1,li=filteredData.length;i<li;i++){var el=createResultElement(filteredData[i]);fragment.appendChild(el.get(0))}}table.get(0).appendChild(fragment)}function fuzzySearch(){setTimeout(function(){var fuzzySearchOptions={pre:"<b>",post:"</b>",extract:function(el){return el.string}};filteredData=fuzzy.filter(searchFilter[0].value,allData,fuzzySearchOptions);if(onFilter){onFilter(searchFilter[0].value,filteredData,$(".selected").get(0))}updateTableDOM()},1)}return this}})(jQuery);(function(){var cache={};this.tmpl=function tmpl(str,data){var fn=!/\W/.test(str)?cache[str]=cache[str]||tmpl(document.getElementById(str).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};"+"with(obj){p.push('"+str.replace(/[\r\t\n]/g," ").split("{{").join("	").replace(/((^|\}\})[^\t]*)'/g,"$1\r").replace(/\t=(.*?)\}\}/g,"',$1,'").split("	").join("');").split("}}").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return data?fn(data):fn}})();